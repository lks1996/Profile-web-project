<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>이력서 목록 관리</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5" style="max-width: 900px;">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold"><i class="bi bi-files"></i> 내 이력서 목록</h2>

        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createModal">
            <i class="bi bi-plus-lg"></i> 새 이력서 만들기
        </button>
    </div>

    <div class="card shadow-sm border-0">
        <div class="list-group list-group-flush">

            <div th:each="p : ${profiles}" class="list-group-item p-4 d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    <div class="me-3 text-center" style="width: 40px;">
                        <i th:if="${p.active}" class="bi bi-check-circle-fill text-success fs-3" title="현재 노출 중"></i>
                        <i th:unless="${p.active}" class="bi bi-circle text-secondary fs-3" style="opacity: 0.3;"></i>
                    </div>

                    <div>
                        <h5 class="mb-1 fw-bold">
                            <a th:href="@{|/admin/profile/${p.id}|}" class="text-decoration-none text-dark stretched-link">
                                <span th:text="${p.title}">이력서 제목</span>
                            </a>
                            <span th:if="${p.active}" class="badge bg-success ms-2" style="font-size: 0.7rem;">LIVE</span>
                        </h5>
                        <small class="text-muted">
                            최종 수정: <span th:text="${#temporals.format(p.lastModifiedDate, 'yyyy-MM-dd HH:mm')}">Date</span>
                        </small>
                    </div>
                </div>

                <div class="d-flex gap-2" style="z-index: 2;"> <form th:action="@{|/admin/profiles/${p.id}/active|}" method="post" th:if="${!p.active}">
                    <button type="submit" class="btn btn-outline-success btn-sm">
                        <i class="bi bi-broadcast"></i> 노출하기
                    </button>
                </form>

                    <a th:href="@{|/admin/profile/${p.id}|}" class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-pencil"></i> 수정
                    </a>

                    <button class="btn btn-outline-danger btn-sm" onclick="alert('준비 중입니다.')">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            </div>

            <div th:if="${#lists.isEmpty(profiles)}" class="text-center p-5 text-muted">
                생성된 이력서가 없습니다.
            </div>

        </div>
    </div>
</div>

<div class="modal fade" id="createModal" tabindex="-1">
    <div class="modal-dialog">
        <form action="/admin/profiles/create" method="post" class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">새 이력서 만들기</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <label class="form-label">이력서 제목 (용도)</label>
                <input type="text" name="title" class="form-control" placeholder="예: 백엔드 개발자용, 영문 이력서..." required>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                <button type="submit" class="btn btn-primary">생성하기</button>
            </div>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>